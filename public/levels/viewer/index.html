<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
		<title>GRAB Level Preview</title>
		<link rel="preconnect" href="https://fonts.googleapis.com"> 
		<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin> 
		<link href="https://fonts.googleapis.com/css2?family=Roboto&display=swap" rel="stylesheet">
		<script type="text/javascript" src="../../configuration.js"></script>
		<style>
			html, body {
				margin: 0;
				height: 100%;
				overflow: hidden;
				touch-action: pan-x pan-y;
				user-select: none;
				-webkit-user-select: none;
				-moz-user-select: none;
				font-family: 'Roboto', sans-serif;
			}

			.info {
				position: absolute;
				top: 50px;
				left: 10px;
				height: 50%;
				text-align: left;
				z-index: 100;
				display:block;
			}

			.signinfo {
				position: absolute;
				top: 60%;
				left: 10px;
				height: 30%;
				text-align: left;
				z-index: 100;
				overflow-y: auto;
				display:block;
			}

			.buttons {
				position: absolute;
				top: 10px;
				left: 10px;
				right: 10px;
				text-align: left;
				z-index: 100;
				display:block;
			}

			.back-button {
				width: 90px;
				height:  30px;
				font-weight: bold;
				border-radius: 2em;
				box-sizing: border-box;
				text-decoration: none;
				background-color: #FFAE00;
				color: #FFFFFF;
				text-align: center;
				border: none;
			}

			.fullscreen-button {
				width: 90px;
				height:  30px;
				font-weight: bold;
				border-radius: 2em;
				box-sizing: border-box;
				text-decoration: none;
				background-color: #00BC87;
				color: #FFFFFF;
				text-align: center;
				border: none;
				float: right;
			}

		</style>
	</head>
	<body>
		<script type="x-shader/x-vertex" id="level-vertexShader">
			varying vec3 vWorldPosition;
			varying vec3 vNormal;

			void main()
			{
				vec4 worldPosition = modelMatrix * vec4(position, 1.0);
				vWorldPosition = worldPosition.xyz;

				vec4 worldNormal = modelMatrix * vec4(normal, 0.0);
				vNormal = worldNormal.xyz;

				gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
			}
		</script>

		<script type="x-shader/x-fragment" id="level-fragmentShader">
			varying vec3 vWorldPosition;
			varying vec3 vNormal;

			uniform sampler2D colorTexture;
			uniform float tileFactor;
			uniform vec3 diffuseColor;

			void main()
			{
				vec3 lightDirection = vec3(1.0, 1.0, 1.0);
				lightDirection = normalize(lightDirection);

				float lightFactor = 0.5 + dot(normalize(vNormal), lightDirection) * 0.5 + 0.5;

				vec4 color = vec4(lightFactor, lightFactor, lightFactor, 1.0);

				vec3 blendNormals = abs(vNormal);
				if(blendNormals.x > blendNormals.y && blendNormals.x > blendNormals.z)
				{
					color.rgb *= texture2D(colorTexture, vWorldPosition.zy * tileFactor).rgb;
				}
				else if(blendNormals.y > blendNormals.x && blendNormals.y > blendNormals.z)
				{
					color.rgb *= texture2D(colorTexture, vWorldPosition.xz * tileFactor).rgb;
				}
				else
				{
					color.rgb *= texture2D(colorTexture, vWorldPosition.xy * tileFactor).rgb;
				}

				color.rgb *= diffuseColor;

				gl_FragColor = color;
			}
		</script>

		<script type="x-shader/x-vertex" id="startfinish-vertexShader">
			varying vec2 vTexcoord;

			void main()
			{
				vTexcoord = uv;
				gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
			}
		</script>

		<script type="x-shader/x-fragment" id="startfinish-fragmentShader">
			varying vec2 vTexcoord;

			uniform vec4 diffuseColor;

			void main()
			{
				vec4 color = diffuseColor;
				float factor = vTexcoord.y;
				factor *= factor * factor;
				factor = clamp(factor, 0.0, 1.0);
				color.a = factor;

				gl_FragColor = color;
			}
		</script>

		<script type="x-shader/x-vertex" id="sign-vertexShader">
			varying vec2 vTexcoord;
			varying vec3 vNormal;

			void main()
			{
				vec4 worldNormal = modelMatrix * vec4(normal, 0.0);
				vNormal = worldNormal.xyz;
				vTexcoord = uv;
				gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
			}
		</script>

		<script type="x-shader/x-fragment" id="sign-fragmentShader">
			varying vec2 vTexcoord;
			varying vec3 vNormal;
			uniform sampler2D colorTexture;

			void main()
			{
				vec3 lightDirection = vec3(1.0, 1.0, 1.0);
				lightDirection = normalize(lightDirection);
				float lightFactor = 0.5 + dot(normalize(vNormal), lightDirection) * 0.5 + 0.5;

				gl_FragColor = texture2D(colorTexture, vTexcoord) * lightFactor;
			}
		</script>

		<script type="text/javascript" src="https://cdn.rawgit.com/dcodeIO/protobuf.js/6.11.2/dist/protobuf.js"></script>
		<script type="module" src="level_viewer.js"></script>

		<div id="info" class="buttons">
		<form>
			<input type="button" id="back-button" class="back-button" value="BACK">
			<input type="button" value="FULLSCREEN" id="fullscreen" class="fullscreen-button">
		</form>
		</div>

		<div id="info" class="info">
		<br>
		<div id="title">title</div>
		<div id="creators">creators</div>
		<div id="description">description</div>
		<div id="complexity">complexity</div>
		<br>
		<div id="total played count">total played count</div>
		<div id="total finished count">total finished count</div>
		<div id="players played count">players played count</div>
		<div id="players finished count">players finished count</div>
		<div id="players rated count">players rated count</div>
		<div id="players liked count">players liked count</div>
		<div id="average time">average time</div>
		</div>

		<div id="signtextcontainer" class="signinfo">
		</div>

		<!-- Cloudflare Web Analytics --><script defer src='https://static.cloudflareinsights.com/beacon.min.js' data-cf-beacon='{"token": "6a50a84f2a35413b953ceffc91acf421"}'></script><!-- End Cloudflare Web Analytics -->
	</body>
</html>